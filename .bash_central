#########################################################
# Contains commands to use in central config which would 
# otherwise only work in prod
#########################################################

procflat(){

# Incase this gets copied to a prod network lets make sure it only works here.
if [[ "$DOMAIN" == "dev-lon" ]] && pwd | grep -q '/srg/dev/release/prod-config'; then

    local __pba_git_root=`git rev-parse --show-toplevel`
    local __pba_pf_files=

    # Lets make sure they don't want just one file.
    local shift_next=0

    for arg do
        shift
        if [[ "$arg" == "-f" ]]; then
            shift_next=1
            continue

        elif [[ "$shift_next" == "1" ]]; then # im not smart enough so just shift the next one too
            shift_next=0
            __pba_pf_files=()

            if echo $arg | grep -q '\/'; then # we want to check if we've been given the full path or not.
                __pba_pf_files+="$arg"
            else
                __pba_pf_files+="$__pba_git_root/$arg"
            fi
            continue
        fi
        set -- "$@" "$arg"
    done

    if [[ -z $__pba_pf_files ]]; then
        __pba_pf_files=(`find $__pba_git_root -maxdepth 1 -type f -name "procMan.*"`)
    fi  

    $RUNTIME_RELEASE/scr/procflat -f ${__pba_pf_files[@]} $*
    return $?
else
    $RUNTIME_RELEASE/scr/procflat $*
    return $?
fi

}

# procMan.ini
__central_vini () {
    # Incase this gets copied to a prod network lets make sure it only works here.
    if [[ "$DOMAIN" == "dev-lon" ]] && pwd | grep -q '/srg/dev/release/prod-config'; then
        __pba_git_root=`git rev-parse --show-toplevel`

        vi $__pba_git_root/procMan.ini
    else
        vi $RELEASE/data/procMan.ini
    fi
}

# -----------------------------------------------------------------------------
# procMan.ora
__central_vora () {
    # Incase this gets copied to a prod network lets make sure it only works here.
    if [[ "$DOMAIN" == "dev-lon" ]] && pwd | grep -q '/srg/dev/release/prod-config'; then
        __pba_git_root=`git rev-parse --show-toplevel`

        vi $__pba_git_root/procMan.ora
    else
        vi $RELEASE/data/procMan.ora
    fi
}

# -----------------------------------------------------------------------------
# procMan.comm_prices
__central_vcom () {
    # Incase this gets copied to a prod network lets make sure it only works here.
    if [[ "$DOMAIN" == "dev-lon" ]]; then
        __pba_git_root=`git rev-parse --show-toplevel`

        vi $__pba_git_root/procMan.comm_prices
    else
        vi $RELEASE/data/procMan.comm_prices
    fi
}

# -----------------------------------------------------------------------------
# procMan.arb_prices
__central_varb () {
    # Incase this gets copied to a prod network lets make sure it only works here.
    if [[ "$DOMAIN" == "dev-lon" ]] && pwd | grep -q '/srg/dev/release/prod-config'; then
        __pba_git_root=`git rev-parse --show-toplevel`

        vi $__pba_git_root/procMan.arb_prices
    else
        vi $RELEASE/data/procMan.arb_prices
    fi
}

# -----------------------------------------------------------------------------
# procMan.bas_prices
__central_vbas () {
    # Incase this gets copied to a prod network lets make sure it only works here.
    if [[ "$DOMAIN" == "dev-lon" ]] && pwd | grep -q '/srg/dev/release/prod-config'; then
        __pba_git_root=`git rev-parse --show-toplevel`

        vi $__pba_git_root/procMan.bas_prices
    else
        vi $RELEASE/data/procMan.bas_prices
    fi
}

# -----------------------------------------------------------------------------
# procMan.de_prices
__central_vde () {
    # Incase this gets copied to a prod network lets make sure it only works here.
    if [[ "$DOMAIN" == "dev-lon" ]] && pwd | grep -q '/srg/dev/release/prod-config'; then
        __pba_git_root=`git rev-parse --show-toplevel`

        vi $__pba_git_root/procMan.de_prices
    else
        vi $RELEASE/data/procMan.de_prices
    fi
}

alias vini='__central_vini'
alias vora='__central_vora'
alias varb='__central_varb'
alias vcomm='__central_vcom'
alias vbas='__central_vbas'
alias vde='__central_vde'
